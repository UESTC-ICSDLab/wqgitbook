## 矩阵键盘原理

在介绍矩阵键盘之前, 我们先来介绍独立按键的工作原理. 按键是一个简单的基础外设, 只需要检测按键上的电平信号, 就可以判断按键是否被按下. 需要注意的是, 如下图所示在按下按键的过程, 会出现电平不稳定的情况, 持续时间大概为 1-10ms, 这就有可能会触发多次按键按下的信号, 因此需要对按键进行消抖处理. 这里我们采取的消抖方案为连续若干个周期检查到有效电平就认定按键按下.

<div align ="center"><img src="/img/lab4/04.png" alt="01" style="zoom:100%;" />

<center style="color:#000000;font-size:10pt;">按键按下的电平变化</center>

本实验所使用的开发板上有一个 4x4 的矩阵键盘, 其原理图如下图所示. 矩阵键盘的使用是为了减少键盘对芯片输入/输出端口的使用, 如下图所示控制 16 个按键只需要 8 个端口, 而如果每个按键占用一个端口就需要 16 个端口. 矩阵键盘的驱动原理就比独立按键稍微复杂一些. 矩阵键盘采用的是扫描方式进行检查, 即依次让矩阵键盘的行线输出改变, 然后检查列线的电平变化, 这样就能定位被按下按键的坐标.

<div align ="center"><img src="/img/lab4/05.png" alt="01" style="zoom:100%;" />

<center style="color:#000000;font-size:10pt;">矩阵键盘原理图</center>

lab4 的第一个实验只使用了按键 KEY0-KEY3 因此不需要扫描, 只需保持 KEY4 信号线为低电平即可. 从上图中可以看出, KEY4 信号线为低电平时, 如果按键 KEY3 被按下, 则 KEY5 信号线输出为低电平. 类似的, 如果按键 KEY2 被按下, 则 KEY6 信号线输出为低电平.

<!-- -->

> #### fread::扩展阅读
> 在FPGA上驱动矩阵键盘的原理和一种按键消抖的实现方法 [矩阵键盘](https://zhuanlan.zhihu.com/p/260372039)